<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['treemap']});
      google.charts.setOnLoadCallback(getTreemapPackagesApi);

      function getTreemapPackagesApi(){
          try {
                $.ajax({
                    async: true,
                    crossDomain: true,
                    url: "http://softwarerepositoryws.gonzalez.cr/api/SoftwareVisualization/GetPackagesByRevision?revisionId=00000004052",
                    type: 'GET',
                    dataType: 'json',
                    xhrFields: {
                        withCredentials: false
                    },
                    processData: false,

                    success: function (data, status) {

                         for(var i = 0; i<data.resultado.length; i++){
                                delete data.resultado[i].packagelongId;
                                delete data.resultado[i].packageId;
                                delete data.resultado[i].structId;
                                delete data.resultado[i].package;
                                delete data.resultado[i].path;
                                delete data.resultado[i].percentage;
                         }
                         drawChart(data);
                    },

                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Estado de la conexión: " + textStatus + " ");
                        console.log("Error de conexión: " + errorThrown + " ");
                    }
                });
            } catch (err) {
                console.log("Ocurrio un error: " + err);
            }// fin catch
        }

      function drawChart(treemapData) {
      var data = new google.visualization.DataTable();
      data.addColumn('string', 'ID');
      data.addColumn('string', 'Parent');
      data.addColumn('number', 'Number Of Lines');
      
      for(var i = 0; i<treemapData.resultado.length; i++){
        if(i === 0){
            data.addRows([['Revision 4052', null, 0]]);
        }else {
            data.addRows([[treemapData.resultado[i].shortPackageName, 'Revision 4052', treemapData.resultado[i].children]]);
        }
      }
      console.log(data);

      var tree = new google.visualization.TreeMap(document.getElementById('chart_div'));

      var options = {
        highlightOnMouseOver: true,
        maxDepth: 1,
        maxPostDepth: 2,
        minHighlightColor: '#8c6bb1',
        midHighlightColor: '#9ebcda',
        maxHighlightColor: '#edf8fb',
        minColor: '#009688',
        midColor: '#f7f7f7',
        maxColor: '#ee8100',
        headerHeight: 15,
        showScale: true,
        height: 500,
        useWeightedAverageForAggregation: true
      };

        tree.draw(data, options);
      }
    </script>
  </head>
  <body>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <div id="chart_div"></div>

  </body>
</html>